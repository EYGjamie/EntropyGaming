<div class="space-y-6">
  <!-- Header -->
  <div class="flex justify-between items-center">
    <div>
      <h1 class="text-3xl font-bold text-gray-900">Benutzer</h1>
      <p class="text-gray-600 mt-1">√úbersicht aller Benutzer in der Organisation</p>
    </div>
    <div class="flex space-x-3">
      <button 
        (click)="exportUsers()"
        class="bg-gray-300 text-gray-700 px-4 py-2 rounded-md text-sm font-medium hover:bg-gray-400 transition-colors"
      >
        üìä Exportieren
      </button>
    </div>
  </div>

  <!-- Error Message -->
  <div *ngIf="error" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded">
    {{ error }}
    <button (click)="error = null" class="float-right text-red-500 hover:text-red-700">‚úï</button>
  </div>

  <!-- Filters -->
  <div class="bg-white shadow rounded-lg p-6">
    <h2 class="text-lg font-medium text-gray-900 mb-4">Filter</h2>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <!-- Search -->
      <div>
        <label for="search" class="block text-sm font-medium text-gray-700 mb-2">Suche</label>
        <input
          id="search"
          type="text"
          [(ngModel)]="filters.search"
          (ngModelChange)="onFilterChange()"
          placeholder="Name oder E-Mail"
          class="block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
        />
      </div>

      <!-- Role Filter -->
      <div>
        <label for="role" class="block text-sm font-medium text-gray-700 mb-2">Rolle</label>
        <select
          id="role"
          [(ngModel)]="filters.role"
          (ngModelChange)="onFilterChange()"
          class="block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
        >
          <option value="">Alle Rollen</option>
          <option *ngFor="let role of availableRoles" [value]="role.id">
            {{ role.displayName }}
          </option>
        </select>
      </div>

      <!-- Status Filter -->
      <div>
        <label for="status" class="block text-sm font-medium text-gray-700 mb-2">Status</label>
        <select
          id="status"
          [(ngModel)]="filters.status"
          (ngModelChange)="onFilterChange()"
          class="block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
        >
          <option value="">Alle Status</option>
          <option value="active">Aktiv</option>
          <option value="inactive">Inaktiv</option>
        </select>
      </div>
    </div>

    <!-- Clear Filters -->
    <div class="mt-4">
      <button
        (click)="clearFilters()"
        class="text-indigo-600 hover:text-indigo-800 text-sm font-medium"
      >
        Filter zur√ºcksetzen
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="flex justify-center items-center h-64">
    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"></div>
  </div>

  <!-- Users Grid -->
  <div *ngIf="!isLoading && filteredUsers.length > 0" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
    <div 
      *ngFor="let user of filteredUsers"
      class="bg-white shadow rounded-lg overflow-hidden hover:shadow-lg transition-all duration-200 cursor-pointer"
      [routerLink]="['/users', user.id]"
    >
      <div class="p-6">
        <!-- User Avatar and Info -->
        <div class="flex items-center space-x-4">
          <div class="flex-shrink-0">
            <img 
              *ngIf="user.profile?.avatarUrl" 
              [src]="user.profile.avatarUrl" 
              [alt]="getUserDisplayName(user)"
              class="h-12 w-12 rounded-full object-cover"
            />
            <div 
              *ngIf="!user.profile?.avatarUrl"
              class="h-12 w-12 rounded-full flex items-center justify-center text-white font-medium"
              [style.background-color]="getRoleColor(user)"
            >
              {{ getUserInitials(user) }}
            </div>
          </div>
          <div class="flex-1 min-w-0">
            <p class="text-lg font-medium text-gray-900 truncate">
              {{ getUserDisplayName(user) }}
            </p>
            <p class="text-sm text-gray-500 truncate">
              {{ user.email }}
            </p>
          </div>
        </div>

        <!-- Role and Status -->
        <div class="mt-4 flex items-center justify-between">
          <span 
            class="inline-flex px-2 py-1 text-xs font-semibold rounded-full"
            [style.background-color]="getRoleColor(user) + '20'"
            [style.color]="getRoleColor(user)"
          >
            {{ user.role.displayName }}
          </span>
          <span 
            class="inline-flex px-2 py-1 text-xs font-semibold rounded-full"
            [class]="getUserStatusBadgeClass(user)"
          >
            {{ getUserStatusText(user) }}
          </span>
        </div>

        <!-- Bio (if available) -->
        <div *ngIf="user.profile?.bio" class="mt-3">
          <p class="text-sm text-gray-600 line-clamp-2">
            {{ user.profile.bio }}
          </p>
        </div>

        <!-- User Meta -->
        <div class="mt-3 text-xs text-gray-500">
          Beigetreten: {{ formatDate(user.createdAt) }}
          <span *ngIf="user.lastLogin">
            ¬∑ Letzter Login: {{ formatDate(user.lastLogin) }}
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div *ngIf="!isLoading && filteredUsers.length === 0" class="text-center py-12">
    <div class="text-gray-500">
      <p class="text-lg font-medium">Keine Benutzer gefunden</p>
      <p class="mt-1">Versuchen Sie, die Filter anzupassen.</p>
    </div>
  </div>

  <!-- Pagination -->
  <div *ngIf="!isLoading && totalPages > 1" class="bg-white shadow rounded-lg">
    <div class="px-6 py-3 flex items-center justify-between border-t border-gray-200">
      <div class="flex-1 flex justify-between sm:hidden">
        <button
          (click)="onPageChange(currentPage - 1)"
          [disabled]="currentPage === 1"
          class="relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:bg-gray-100 disabled:text-gray-400"
        >
          Zur√ºck
        </button>
        <button
          (click)="onPageChange(currentPage + 1)"
          [disabled]="currentPage === totalPages"
          class="ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:bg-gray-100 disabled:text-gray-400"
        >
          Weiter
        </button>
      </div>
      <div class="hidden sm:flex-1 sm:flex sm:items-center sm:justify-between">
        <div>
          <p class="text-sm text-gray-700">
            Zeige <span class="font-medium">{{ getStartEntry() }}</span> bis 
            <span class="font-medium">{{ getEndEntry() }}</span> von 
            <span class="font-medium">{{ totalUsers }}</span> Ergebnissen
          </p>
        </div>
        <div>
          <nav class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px">
            <!-- Previous Button -->
            <button
              (click)="onPageChange(currentPage - 1)"
              [disabled]="currentPage === 1"
              class="relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:bg-gray-100 disabled:text-gray-400"
            >
              ‚Üê
            </button>

            <!-- Page Numbers -->
            <button
              *ngFor="let page of getPageNumbers()"
              (click)="onPageChange(page)"
              [class]="page === currentPage ? 
                'relative inline-flex items-center px-4 py-2 border border-gray-300 bg-indigo-600 text-sm font-medium text-white' :
                'relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50'"
            >
              {{ page }}
            </button>

            <!-- Next Button -->
            <button
              (click)="onPageChange(currentPage + 1)"
              [disabled]="currentPage === totalPages"
              class="relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:bg-gray-100 disabled:text-gray-400"
            >
              ‚Üí
            </button>
          </nav>
        </div>
      </div>
    </div>
  </div>
</div>